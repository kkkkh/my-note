# Use root/example as user/password credentials
version: '3.1'

networks:
  # 网络名字
  mynet:
    # 由网关驱动
    driver: bridge

services:
  app:
    image: iamge_name:tag
    container_name: container_name
    volumes:
      - ~/app/data:/data
      - ~/app/logs:/logs
    build: ./
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: username
      MONGO_INITDB_ROOT_PASSWORD: password
      MONGO_INITDB_ROOT_MODE: pro
    depends_on:
      - mongo
    links:
      - mongo
    networks:
      - mynet
    ports:
      - 9001:3000
  mongo:
    image: mongo
    restart: always
    container_name: mongo
    volumes:
      - ~/mongodb/data:/data/db
    environment:
      MONGO_INITDB_ROOT_USERNAME: username
      MONGO_INITDB_ROOT_PASSWORD: password
    ports:
      - 9002:27017
    networks:
      - mynet
  redis:
    image: redis
    restart: always
    container_name: redis
    ports:
      - 9003:6379
    volumes:
      - ./redis/redis.conf:/etc/redis/redis.conf
      - ./redis/data:/data
      - ./redis/logs:/logs
    command: redis-server /etc/redis/redis.conf
    privileged: true
    environment:
      REDIS_PASSWORD : redis_password
    networks:
      - mynet
